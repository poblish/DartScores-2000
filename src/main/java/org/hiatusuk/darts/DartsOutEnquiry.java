package org.hiatusuk.darts;import java.util.Vector;/**************************************************************************************************************************************************************/public class DartsOutEnquiry{    private DartScoreSet    m_TempScoreSet;    private Vector          mDartsScoresList;    private int             m_NumDartsAvailable;    private int             mNumDartValues = DartScore.kHighestSingleScore - DartScore.kLowestSingleScore + 2;    private int             mDartScoreArray[] = new int [ mNumDartValues ];    long        m_NumLines;    int         m_CurrentFinishingMultiple;    int         m_ThePointsRemaining, m_TotalOnTheFinishingDart, m_ValueOfTheFinishingDart, m_Scores[], m_Multiples[];    boolean     m_IgnoreNextOne;    /*******************************************************************************    *******************************************************************************/    public DartsOutEnquiry( int inOriginalTarget, int how_many_darts_available, boolean inExactlyThatNumDarts)    {        mDartsScoresList = new Vector(50);        //////////////////////////////////////////////////////////////        if (( inOriginalTarget <= DartScore.kLowestSingleScore) ||            ( inOriginalTarget > ( DartScore.kHighestOneDartScore * how_many_darts_available)))        {            return;        }        //////////////////////////////////////////////////////////////        m_ThePointsRemaining = 0;        m_NumDartsAvailable = how_many_darts_available;        m_Scores = new int[ m_NumDartsAvailable - 1];        m_Multiples = new int[ m_NumDartsAvailable - 1];        //////////////////////////////////////////////////////////////        m_NumLines = 0;        // m_NumHits = 0;        //////////////////////////////////////////////////////////////        for ( int theDartScore = DartScore.kLowestSingleScore; theDartScore <= DartScore.kHighestSingleScore; theDartScore++)        {            mDartScoreArray[ theDartScore - DartScore.kLowestSingleScore] = theDartScore;        }        mDartScoreArray[ mNumDartValues-1] = DartScore.kBullValue;        //////////////////////////////////////////////////////////////  See if it can be done in 1 dart first        if (!DartScore.kCanFinishWithAnyDart)        {            for ( int theIndexOfTheFinishingDart = mNumDartValues - 1; theIndexOfTheFinishingDart >= 0; theIndexOfTheFinishingDart--)            {                m_ValueOfTheFinishingDart = DartIndexToValue(theIndexOfTheFinishingDart);                m_TotalOnTheFinishingDart = DartScore.kMultipleNeededForLastDart * m_ValueOfTheFinishingDart;                //////////////////////////////////////////////////////////////                if ( m_TotalOnTheFinishingDart == inOriginalTarget)         // eg. 40 needed - do it in one throw!                {                    if (( inExactlyThatNumDarts && ( m_NumDartsAvailable == 1)) || !inExactlyThatNumDarts)                    {                        m_TempScoreSet = new DartScoreSet();                        m_TempScoreSet.Add( new DartScore( m_ValueOfTheFinishingDart, DartScore.kMultipleNeededForLastDart));                        mDartsScoresList.addElement(m_TempScoreSet);                    }                }            }        }        //////////////////////////////////////////////////////////////  Now try for 2 darts or more, if available, up to the max number        //////////////////////////////////////////////////////////////  If 'kCanFinishWithAnyDart' try EACH multiple for the final dart (phew!)        boolean     keepLooking = DartScore.kCanFinishWithAnyDart ? true : ( m_NumDartsAvailable >= 2);        int         theStartDart = DartScore.kCanFinishWithAnyDart ? 1 : ( inExactlyThatNumDarts ? m_NumDartsAvailable : 2);        int         theIndexOfTheFinishingDart, theFinalDartsMultiple;        if (keepLooking)        {            for ( int theNumDarts = theStartDart; theNumDarts <= m_NumDartsAvailable; theNumDarts++)            {                InitScanArray();                for ( theIndexOfTheFinishingDart = mNumDartValues - 1; theIndexOfTheFinishingDart >= 0; theIndexOfTheFinishingDart--)                {                    if (DartScore.kCanFinishWithAnyDart)                    {                        for ( theFinalDartsMultiple = 1; theFinalDartsMultiple <= DartScore.GetHighestMultipleForDart(theIndexOfTheFinishingDart); theFinalDartsMultiple++)                        {                            m_CurrentFinishingMultiple = theFinalDartsMultiple;                            StandardSearchLoop( inOriginalTarget, theNumDarts, theIndexOfTheFinishingDart);                        }                    }                    else                    {                        m_CurrentFinishingMultiple = DartScore.kMultipleNeededForLastDart;                        StandardSearchLoop( inOriginalTarget, theNumDarts, theIndexOfTheFinishingDart);                    }                }            }        }    }    /*******************************************************************************    *******************************************************************************/    private void StandardSearchLoop( int inOriginalTarget, int inNumDarts, int inCurrDartIndex)    {        m_ValueOfTheFinishingDart = DartIndexToValue(inCurrDartIndex);        m_TotalOnTheFinishingDart = m_CurrentFinishingMultiple * m_ValueOfTheFinishingDart;        //////////////////////////////////////////////////////////////        if ( m_TotalOnTheFinishingDart < inOriginalTarget)        {            m_ThePointsRemaining = inOriginalTarget - m_TotalOnTheFinishingDart;            m_IgnoreNextOne = false;            PrintFunc( inNumDarts, 0);        }    }    /*******************************************************************************    *******************************************************************************/    private void InitScanArray()    {        for ( int i = 0; i < m_NumDartsAvailable - 1; i++)        {            m_Scores[i] = DartScore.kLowestSingleScore;     // don't allow any dart score under the minimum (1!)            m_Multiples[i] = 1;        }    }    /*******************************************************************************    *******************************************************************************/    private void PrintFunc( int inDartsAvailable, int inDartIndex)    {        int     theCurrDartIndex, theMultiple, theNextMultiple, theHighestMultiple, theTotal, i;        for ( int theDartIndex = inDartIndex; theDartIndex < ( inDartsAvailable - 1); theDartIndex++)        {            for ( theCurrDartIndex = 0; theCurrDartIndex < mNumDartValues; theCurrDartIndex++)            {                theHighestMultiple = DartScore.GetHighestMultipleForDart(theCurrDartIndex);                for ( theNextMultiple = 1; theNextMultiple <= theHighestMultiple; theNextMultiple++)                {                    m_Scores[theDartIndex] = theCurrDartIndex + DartScore.kLowestSingleScore;                    m_Multiples[theDartIndex] = theNextMultiple;                    if (m_IgnoreNextOne)                    {                        m_IgnoreNextOne = false;                    }                    else                    {                        m_NumLines++;                        theTotal = 0;                        for ( i = 0; i < inDartsAvailable - 1; i++)                        {                            theTotal += ( DartIndexToValue( m_Scores[i] - DartScore.kLowestSingleScore) * m_Multiples[i]);                        }                        ///////////////////////////////////////////                        if ( theTotal == m_ThePointsRemaining)                        {                            m_TempScoreSet = new DartScoreSet();                            for ( i = 0; i < inDartsAvailable - 1; i++)                            {                                m_TempScoreSet.Add( new DartScore( DartIndexToValue( m_Scores[i] - DartScore.kLowestSingleScore), m_Multiples[i]));                            }                            m_TempScoreSet.Add( new DartScore( m_ValueOfTheFinishingDart, m_CurrentFinishingMultiple));                            ///////////////////////////////////////////                            mDartsScoresList.addElement(m_TempScoreSet);                            // System.out.println(m_TempScoreSet);                        }                    }                    if (( theCurrDartIndex == ( mNumDartValues - 1)) && ( theNextMultiple == theHighestMultiple))                    {                        m_IgnoreNextOne = true;                    }                    if ( theDartIndex < ( inDartsAvailable - 1))                    {                        PrintFunc( inDartsAvailable, theDartIndex + 1);                    }                }            }        }    }    /*******************************************************************************    *******************************************************************************/    public int DartIndexToValue( int inDartIndex)    {        return mDartScoreArray[inDartIndex];    }    /*******************************************************************************    *******************************************************************************/    public Vector GetScores()    {        return mDartsScoresList;    }};